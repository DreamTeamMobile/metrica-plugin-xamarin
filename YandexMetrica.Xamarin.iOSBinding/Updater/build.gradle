plugins {
  id "org.openbakery.xcode-plugin" version "0.12.3"
}

task buildForSimulator(dependsOn: build) {
}

task buildForDevice(dependsOn: build) {
}

xcodebuild {
  scheme = 'EmptyApplication'
  target = 'EmptyApplication'
  configuration = 'Release'
  arch = ['armv7', 'armv7s', 'i386', 'x86_64', 'arm64']
}

gradle.taskGraph.whenReady { taskGraph ->

    if (taskGraph.hasTask(buildForDevice)) {
        xcodebuild {
            simulator = false
        }
    }

    if (taskGraph.hasTask(buildForSimulator)) {
        xcodebuild {
            simulator = true

            destination {
                platform = 'iOS Simulator'
            }
        }
    }
}
